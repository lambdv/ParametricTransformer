- make subs optimization method
- clean code structure and add comments